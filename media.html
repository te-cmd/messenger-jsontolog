<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Messenger Media Viewer</title>
  <style>
    body { font-family: monospace; background:#fff; color:#000; padding:20px; }
    h2 { margin-top:0; }
    .controls { display:flex; gap:12px; align-items:center; margin-bottom:12px; }
    input[type="file"] { font-family: monospace; }
    button { padding:6px 10px; font-family: monospace; }
    #fileInfo { font-size:14px; color:#333; margin-bottom:12px; }

    /* grid layout */
    #media {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); /* responsive */
      gap: 12px;
      background:#f7f7f7;
      border:1px solid #ddd;
      padding:10px;
      max-height:70vh;
      overflow:auto;
    }

    .media-item {
      background:#fff;
      border:1px solid #ccc;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      padding:6px;
    }

    .media-preview {
      width: 100%;
      aspect-ratio: 16/9;      /* fixed box 16:9 */
      background:#000;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
    }

    .media-preview img,
    .media-preview video {
      width: 100%;
      height: 100%;
      object-fit: cover;       /* fills box */
    }

    .media-preview audio {
      width: 100%;
      height: 40px;            /* fixed height for audio player */
    }

    .filename {
      margin-top:6px;
      font-size:12px;
      color:#444;
      text-align:center;
      word-break:break-all;
    }
  </style>
</head>
<body>
  <h2>Messenger Media Viewer</h2>

  <div class="controls">
    <label>
      Upload media folder:
      <input type="file" id="mediaInput" webkitdirectory directory multiple>
    </label>
    <button id="viewBtn">View Media</button>
  </div>

  <div id="fileInfo">No media files loaded</div>
  <div id="media"></div>

  <script>
  const mediaInput = document.getElementById("mediaInput");
  const mediaDiv = document.getElementById("media");
  const fileInfo = document.getElementById("fileInfo");

  let files = [];

  mediaInput.addEventListener("change", () => {
    files = Array.from(mediaInput.files);
    fileInfo.textContent = `${files.length} media file(s) loaded`;
  });

  document.getElementById("viewBtn").addEventListener("click", () => {
    mediaDiv.innerHTML = "";
    if (files.length === 0) {
      alert("Please upload a media folder first.");
      return;
    }

    files.forEach(file => {
      const url = URL.createObjectURL(file);
      const lower = file.name.toLowerCase();

      const wrapper = document.createElement("div");
      wrapper.className = "media-item";

      const preview = document.createElement("div");
      preview.className = "media-preview";

      if (lower.endsWith(".mp3") || lower.endsWith(".ogg") || lower.endsWith(".wav")) {
        const audio = document.createElement("audio");
        audio.src = url;
        audio.controls = true;
        preview.appendChild(audio);
      } else if (lower.endsWith(".mp4")) {
        const video = document.createElement("video");
        video.src = url;
        video.controls = true;
        preview.appendChild(video);
      } else if (lower.match(/\.(jpeg|jpg|png|gif)$/)) {
        const img = document.createElement("img");
        img.src = url;
        img.alt = file.name;
        preview.appendChild(img);
      } else {
        const div = document.createElement("div");
        div.textContent = `[File: ${file.name}]`;
        div.style.color = "#888";
        preview.appendChild(div);
      }

      const label = document.createElement("div");
      label.className = "filename";
      label.textContent = file.name;

      wrapper.appendChild(preview);
      wrapper.appendChild(label);
      mediaDiv.appendChild(wrapper);
    });
  });
  </script>
</body>
</html>
